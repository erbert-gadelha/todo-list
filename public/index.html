<head>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

        :root {
        --color-0: white;
        --color-1: rgba(23, 23, 23, 1);
        --color-2: rgba(23, 23, 23, 1);
        --color-3: rgba(23, 23, 23, 0.6);
        --color-alta: rgba(233, 27, 27, 1);
        --color-media: rgba(233, 150, 27, 1);
        --color-baixa: rgba(82, 186, 45, 1);
        }

        * {
        margin: 0;
        padding: 0;
        font-family: "Poppins", sans-serif;
        box-sizing: border-box;
        border: none;
        }

        body {
        display: flex;
        justify-content: center;
        align-items: center;
        
        height: 100vh;
        
        background-color: white;
        }

        #todo-items {
        --button-size: 25px;
        
        display: grid;
        grid-template-columns: [container-start selector-start] var(--button-size) [selector-end item-start] 0px [title-start] auto [title-end priority-start] 90px [priority-end edit-start] var(--button-size) [edit-end] 0px [item-end container-end];
        
        grid-auto-rows: auto;
        
        gap: 6px;
        width: fit-content;
        width: 100%;
        max-width: 600px;
        margin: 0 20px;
        height: fit-content;
        padding: 10px;
        border-radius: 8px;
        background-color: var(--color-0);
        box-shadow: 0 0 0px 6px var(--color-1), 0 -12px 0px 6px var(--color-1);
        
        }

        #todo-add {
        padding: 6px;
        height: fit-content;
        grid-column: container-start/container-end;
        grid-row: span;
        background-color: var(--color-2);
        cursor: pointer;
        color: var(--color-0);
        border-radius: 8px;
        }

        .todo-item {
        display: grid;
        grid-column: container-start/container-end;
        grid-row: span;
        
        grid-template-columns: subgrid;
        
        
        .todo-done {
            position: relative;
            height: var(--button-size);
            margin: auto 0;
            cursor: pointer;
            border-radius: 6px;
            background-color: var(--color-3);
        }
        
        .todo-edit {
            background-color: var(--color-0);
            height: var(--button-size);
            cursor: pointer;
            border-radius: 6px;
        }
        
        .todo-priority {
            color: white;
            background-color: gray;
            grid-column: priority-start/priority-end;
            border-radius: 50px;
            text-align: center;
            
            &.todo-priority-alta {
            background-color: var(--color-alta);
            }
            &.todo-priority-media {
            background-color: var(--color-media);
            }
            &.todo-priority-baixa {
            background-color: var(--color-baixa);
            }
        }
        
        .todo-title {
            grid-column: title-start/title-end;
            color: var(--color-0);
            font-weight: normal;
            
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
            text-justify: center;
            vertical-align: middle;
            line-height: 20px;
        }
        
        div {
            box-sizing: content-box;
            padding: 8px 0px;
            display: grid;
            grid-column: item-start/item-end;
            grid-template-columns: subgrid;
            border-radius: 8px;
            background-color: var(--color-2);
        }
        
        
        }



        .todo-item-done {
        
        .todo-done:after {
            content:"✓";
            width: 100%;
            height: 100%;
            color: var(--color-0);
        }
        }

    </style>
</head>

<body>
    <section id="todo-items">
      <div id="todo-add">+ add todo</div>
    </section>


    <script>
        const todoAdd = document.getElementById("todo-add");
        const todoItems = document.getElementById("todo-items");

        const items = [];

        const temp = [{
            id: 0,
            title: "Dar banho no cachorro",
            description: "Usar shampoo anti-pulga.",
            priority: 1,
            done: false,
            doneAt: null
        },{
            id: 1,
            title: "Dar banho no gato",
            description: "Usar shampoo anti-rato.",
            priority: 2,
            done: false,
            doneAt: null
        },{
            id: 2,
            title: "Tomar banho",
            description: "Usar shampoo anti-capsta.",
            priority: 0,
            done: false,
            doneAt: null
        }];



        for(let i = 0; i < temp.length; i++) {
        const todoItem = CreateTodoItem(temp[i]);
        todoItems.append(todoItem);
        
        items.push({
            content: temp[i],
            element: todoItem
        });
        }

        let id_ = items.length;

        todoAdd.addEventListener("click", () => {
        
        const itemData = {
            id: id_++,
            title: "no title",
            description: "no description",
            priority: undefined,
            done: false,
            doneAt: null
        }
                
        const todoItem = CreateTodoItem(itemData);
        todoItems.append(todoItem);
        
        items.push({
            content: itemData,
            element: todoItem
        });
        
        });


        function CreateTodoItem(param) {
        
        const todoItem = document.createElement("div");
        todoItem.classList.add("todo-item");
        
        const todoDoneButton = document.createElement("button");
        todoDoneButton.classList.add("todo-done");
        todoItem.appendChild(todoDoneButton);
        
        todoDoneButton.addEventListener("click", () => {
            EditTodoItem(param.id);
        });

        const itemDiv = document.createElement("div");
        itemDiv.classList.add("item");
        todoItem.appendChild(itemDiv);

        const todoTitle = document.createElement("span");
        todoTitle.classList.add("todo-title");
        todoTitle.textContent = param.title;
        itemDiv.appendChild(todoTitle);

        const todoPriority = document.createElement("span");
        todoPriority.classList.add("todo-priority");
        switch(param.priority) {
            case 2:
            todoPriority.textContent = "alta";
        todoPriority.classList.add("todo-priority-alta");
            break;
            case 1:
            todoPriority.textContent = "média";
            todoPriority.classList.add("todo-priority-media");
            break;
            case 0:
            todoPriority.textContent = "baixa";
            todoPriority.classList.add("todo-priority-baixa");
            break;
            default:
            todoPriority.textContent = "undefined";
        }
        itemDiv.appendChild(todoPriority);

        const todoEditButton = document.createElement("button");
        todoEditButton.classList.add("todo-edit", "material-symbols-outlined");
        todoEditButton.textContent = "edit";
        itemDiv.appendChild(todoEditButton);
        
        if(param.done)
            todoItem.classList.add("todo-item-done");

        return todoItem;
        }

        function EditTodoItem(itemId) {
        const todoItem = items.find(item => item.content.id === itemId);
        if(todoItem == undefined || todoItem == null)
            return;
        
        todoItems.removeChild(todoItem.element);
        }

        function RemoveTodoItem(itemId) {
        const todoItem = items.find(item => item.content.id === itemId);
        if(todoItem == undefined || todoItem == null)
            return;
        
        //items.splice(index, 1);
        todoItems.removeChild(todoItem.element);
        }
    </script>
</body>